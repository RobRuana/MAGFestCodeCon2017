<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">

    <title>Thoughts on Ubersystem</title>

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/white.css">

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/github.css">

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>

    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->

    <style>
      /* Border Box */
      html { box-sizing: border-box; }
      *, *:before, *:after { box-sizing: inherit; }

      /* Jumpy Fonts on Safari */
      * { -webkit-transform-style: preserve-3d; }

      /* Layout Classes */
      .reveal .block { display: block; }
      .reveal .clearfix { clear: both; }
      .reveal .inline { display: inline; }
      .reveal .inline-block { display: inline-block; }
      .reveal .pull-left { float: left; }
      .reveal .pull-right { float: right; }
      .reveal .paragraph {
        line-height: 1.3;
        margin-bottom: 20px;
        margin-top: 20px;
      }

      /* Text Classes */
      .reveal .text-xl { font-size: 1.5em; }
      .reveal .text-lg { font-size: 1.25em; }
      .reveal .text-md { font-size: 1em; }
      .reveal .text-sm { font-size: 0.75em; }
      .reveal .text-xs { font-size: 0.5em; }
      .reveal .text-pre { white-space: pre; }
      .reveal .text-mono { font-family: monospace; }
      .reveal .text-red { color: #ff0000; }
      .reveal .text-light { opacity: 0.375; }
      .reveal .text-subtle { opacity: 0.5; }
      .reveal .text-normal { font-style: normal; }
      .reveal .text-italic { font-style: italic; }
      .reveal .text-bold { font-weight: bold; }
      .reveal .text-center { text-align: center; }
      .reveal .text-left { text-align: left; }
      .reveal .text-right { text-align: right; }

      /* Element Defaults */

      .reveal blockquote {
        width: 90%;
        padding: 0.5em;
        background-color: #f8f8f8;
      }

      .reveal code {
        padding-left: 0.25em;
        padding-right: 0.25em;
      }

      .reveal h1, .reveal h2, .reveal h3, .reveal h4, .reveal h5, .reveal h6 {
        text-transform: none;
      }

      .reveal ol, .reveal ul,
      .reveal ol ol, .reveal ol ul,
      .reveal ul ol, .reveal ul ul { margin: 0; }
      .reveal ol li, .reveal ul li { margin-left: 1.25em; }

      .reveal .list-none { list-style: none; }
      .reveal .list-none li { margin-left: 0; }

      .reveal pre { box-shadow: none; margin: 0 auto; }
      .reveal pre code { max-height: 600px; }
      .reveal section { text-align: left; }

      .reveal section img {
        margin: 0;
        background: none transparent;
        border: 0 none transparent;
        box-shadow: none;
      }

      /* Layered Image */

      .reveal .img {
        position: relative;
        width: 1600px;
        height: 774px;
      }

      .reveal .img .img-layer {
        position: absolute;
        left: 0;
        top: 0;
        width: 1520px;
        height: 720px;
      }

      /* Monospace Font */
      .reveal code, .reveal .file, .reveal .plugin, .reveal .db, .reveal .service,
      .reveal code *, .reveal .file *, .reveal .plugin *, .reveal .db *, .reveal .service * {
        font-family: monospace;
      }

      /* DB Table */
      .reveal .db .db-table table th,
      .reveal .db .db-table table td,
      .reveal .db .db-table table tbody tr:last-child th,
      .reveal .db .db-table table tbody tr:last-child td {
        border: 1px solid #606060;
      }

      .reveal .db .db-table {
        width: 100%;
        padding: 0 1.25em 1.25em;"
      }

      .reveal .db .db-table table {
        width: 100%;
      }

      /* Gray Block Backgrounds */
      .reveal code, .reveal .panel, .reveal .plugin, .reveal .service {
        background-color: #f0f0f0;
        border: 1px solid rgba(0, 0, 0, 0.1);
        border-radius: 3px;
        color: #333;
      }

      .reveal .panel pre {
        font-size: 1em;
        margin: 0 0 0 1.25em;
        width: 100%;
      }

      .reveal .panel pre code {
        background-color: transparent;
        border: 0 none transparent;
        border-radius: 0;
      }

      .reveal .panel .panel,
      .reveal .panel .plugin { background-color: #e0e0e0; }
      .reveal .panel .panel .panel,
      .reveal .panel .panel .plugin { background-color: #d0d0d0; }
      .reveal .panel .panel .panel .panel,
      .reveal .panel .panel .panel .plugin,
      .reveal .panel .panel .plugin .panel { background-color: rgba(0, 0, 0, 0.1); }

      /* Plugins */
      .reveal .plugin { display: inline-block; }
      .reveal .plugin, .reveal .service {
        padding: 0 0.25em;
      }

      .reveal li .plugin {
        margin-bottom: 0.25em;
      }

      .reveal .folder .plugin {
        padding: 0.25em 0.5em;
        display: block;
      }

      /* Panels */
      .reveal .panel {
        padding: 0.5em;
        margin-bottom: 0.25em;
      }

      .reveal .panel:last-child {
        margin-bottom: 0;
      }

      .reveal .plugin .panel {
        margin-bottom: 0;
        padding: 0.2em 0.5em;
      }

      .reveal .panel h1, .reveal .panel h2, .reveal .panel h3,
      .reveal .panel h4, .reveal .panel h5, .reveal .panel h6 {
        margin-bottom: 0.25em;
      }

      .reveal .panel h1 { font-size: 1.25em; }

      .panel ul { list-style: none; }
      .panel .panel { font-size: 0.75em; margin-left: 1.25em; }
      .panel li .panel { margin-left: 0; }
      .panel .panel li { margin-left: 0; }

      /* Columns */
      .reveal .col-1, .reveal .col-2, .reveal .col-3, .reveal .col-4,
      .reveal .col-5, .reveal .col-6, .reveal .col-7, .reveal .col-8,
      .reveal .col-9, .reveal .col-10, .reveal .col-11, .reveal .col-12 {
        float: left;
        padding-left: 15px;
        padding-right: 15px;
        width: 100%;
      }

      .reveal .col-1 { width: 8.3%; }
      .reveal .col-2 { width: 16.6%; }
      .reveal .col-3 { width: 25%; }
      .reveal .col-4 { width: 33.3%; }
      .reveal .col-5 { width: 41.6%; }
      .reveal .col-6 { width: 50%; }
      .reveal .col-7 { width: 58.3%; }
      .reveal .col-8 { width: 66.6%; }
      .reveal .col-9 { width: 75%; }
      .reveal .col-10 { width: 83.3%; }
      .reveal .col-11 { width: 91.6%; }
      .reveal .col-12 { width: 100%; }

      /* Icons */
      .reveal .icon,
      .reveal .title::before {
        content: " ";
        background-repeat: no-repeat;
        background-size: 100% 100%;
        display: inline-block;
        margin-right: 0.25em;
        height: 1.5em;
        width: 1.5em;
        vertical-align: middle;
      }

      .service > .title::before, .glyphicon-cogwheels { background-image: url(images/glyphicons/glyphicons-cogwheels.png); }
      .db > .title::before, .glyphicon-database { background-image: url(images/glyphicons/glyphicons-database.png); }
      .folder > .title::before, .glyphicon-folder { background-image: url(images/glyphicons/glyphicons-folder-open.png); }
      .plugin > .title::before, .glyphicon-puzzle { background-image: url(images/glyphicons/glyphicons-puzzle.png); }
      .file > .title::before, .glyphicon-file { background-image: url(images/glyphicons/glyphicons-file.png); }
      .package > .title::before, .glyphicon-package { background-image: url(images/glyphicons/glyphicons-cube-black.png); }
    </style>
  </head>

  <body>
    <div class="reveal">
      <div class="slides">

<section class="text-center">
  <h1>Thoughts on Ubersystem</h1>
  <p class="text-sm text-subtle text-italic">Press O to toggle overview</p>
  <p class="text-sm text-subtle text-italic">Press S to toggle speaker notes</p>
  <p class="text-sm text-subtle text-italic">Arrow keys ←, ↑, →, ↓, to navigate</p>
  <p class="text-sm text-subtle text-italic">
    Slides available:
    <a href="http://robruana.com/ThoughtsOnUbersystem/">
      robruana.com/ThoughtsOnUbersystem
    </a>
  </p>
  <p class="text-sm text-subtle text-italic">
    Source available:
    <a href="https://github.com/RobRuana/ThoughtsOnUbersystem/">
      github.com/RobRuana/ThoughtsOnUbersystem
    </a>
  </p>

  <aside class="notes">
    Hey everybody, my name is Rob Ruana, and I'm the Director of Software
    Engineering at MAGFest.
    <br><br>
    Today – if you'll let me – I'd like to talk about the future of software
    development at MAGFest.
    <br><br>
    In particular, I have some thoughts on Ubersystem, the software we
    developed in-house to handle event registration and volunteer management.
    <br><br>
    These slides and their source code is available online at the provided
    links.
  </aside>
</section>

<section>
  <h1>Overview</h1>
  <ol>
    <li class="fragment">
      Review pain points in current system
      <aside class="notes">
        The first thing we're going to cover are a few pain points in our
        current system. These are – I guess – design decisions that have caused
        serious development, or maintenance headaches. These might be things
        that've prevented us from scaling up to handle heavy load, or have just
        been generally annoying.
      </aside>
    </li>
    <li class="fragment">
      Proposal for refactoring current system
      <aside class="notes">
        The next thing we'll cover are some ideas for refactoring the current
        system to alleviate some of our pain points
      </aside>
    </li>
    <li class="fragment">
      Proposal for persistent system
      <aside class="notes">
        And finally, we'll cover a proposal for a multi-year, multi-event,
        persistent system to replace our current paradigm – which is one server
        per-event.
      </aside>
    </li>
  </ol>
</section>

<section>
  <section>
    <h1>Pain Points</h1>
    <div class="text-center">
      <p class="fragment text-md">The tradition of Festivus begins with the airing of grievances.</p>
      <p class="fragment text-lg">I got a lot of problems with you people...</p>
      <p class="fragment text-xl">And now, you're gonna hear about it!</p>
    </div>
    <aside class="notes">
      After putting this presentation together, I realized I spent the first
      <em>half</em> of the presentation <em>absolutely railing</em>
      on the current code base. So I think it's really important to take a
      moment to say I am not criticizing – or judging – the developers that
      built the current system. It grew organically over several iterations,
      created by volunteers working in their spare time. So I totally
      understand how the system grew to be the way it is, and why things are
      the way they are.
      <br><br>
      And I should mention, every developer writes bad code, myself included!
      Any developer that tells you they don't write bad code has fooled
      themselves!
      <br><br>
      Right? And there's a lot <em>really good</em> code in there, too!
      There's a lot of great stuff in there!
      <br><br>
      So, caveats aside, let's jump in!
    </aside>
  </section>

  <section>
    <h1>Pain Points</h1>
    <h2>The issue</h2>
    <p>Modules with import side effects:</p>
    <pre class="paragraph"><code data-trim data-noescape>
import sideboard
    </code></pre>

    <aside class="notes">
      A lot of our modules have side effects when they're imported. For
      example, calling <code>import sideboard</code> not only loads every
      available sideboard module and plugin, <em>it also</em> opens a
      connection to your database and initializes your schema.
      <br><br>
      All before that statement even returns!
    </aside>

    <h2 class="fragment">
      Why is this an issue?
      <aside class="notes">
        I know what some of you are thinking... why is this an issue?
      </aside>
    </h2>
    <ol>
      <li class="fragment">
        Circular import dependencies
        <aside class="notes">
          Well, for starters, it makes it much easier to accidentally introduce
          circular import dependencies. You have much less control of how and
          when modules are imported. To avoid circular dependencies, you end up
          having to declare your functions, and put your import statements in
          weird and unexpected places.
        </aside>
      </li>
      <li class="fragment">
        Makes script writing difficult
        <aside class="notes">
          And it's not just circular dependencies. It makes script writing
          much trickier. We have a lot of one-off command line scripts, and
          for most of those we want the full environment loaded with a
          configured database. But sometimes we definitely <em>don't</em>
          want that, like for our database migration scripts.
          <br><br>
          I had to completely redo the way the system loads for our database
          migration scripts, because calling <code>import sideboard</code>
          would try to completely configure the database before the migration
          code even had a chance to run.
          <br><br>
          It was nightmarish!
        </aside>
      </li>
      <li class="fragment">
        Using a package as a library is impossible
        <aside class="notes">
          And you can forget about using the package as a third party library.
          Let's say you just want to use one of sideboard's nice string
          manipulation functions in one of your projects. You'd expect you
          could write
          <code>from sideboard import camelcase_to_underscore</code>, but nope!
          <br><br>
          If you wanna convert a camel case string to underscores, you better
          have a database configured and ready to accept connections!
        </aside>
      </li>
    </ol>
  </section>

  <section>
    <h1>Pain Points</h1>
    <h2>The issue</h2>
    <p><code>common.py</code> and wildcard import statements:</p>
    <pre class="paragraph"><code data-trim data-noescape>
from uber.common import *
    </code></pre>

    <aside class="notes">
      So this is a thing we do all over the place. And it's not just that we
      use wildcard imports.
      <br><br>
      We've managed to magnify the issue by creating a single file called
      <code>common.py</code> into which <em>everything</em> is imported. And
      then in all our other files we do <code>from uber.common import *</code>.
    </aside>

    <h2 class="fragment">
      Why is this an issue?
      <aside class="notes">
        Okay, so if everything's working, why is this even an issue?
      </aside>
    </h2>
    <ol>
      <li class="fragment">
        Name collisions
        <aside class="notes">
          First, it introduces the possibility of name collisions. It's the
          equivalent of taking our heirarchy of namespaces and smooshing them
          down into a single namespace.
          <br><br>
          We might as well be writing PHP at that point!
          <br><br>
          It's entirely possible that we've already got name collisions that
          we don't even know about. Just waiting. Like a bear trap. Waiting to
          <em>clamp</em> down on our poor unsuspecting production servers!
        </aside>
      </li>
      <li class="fragment">
        Static analysis via <code>flake8</code> is impossible
        <aside class="notes">
          Which leads me to my next point. Static analysis against our current
          codebase with tools like <code>flake8</code> is nearly impossible.
          We've already seen several bugs that would have been prevented by
          using <code>flake8</code>.
          <br><br>
          I can't help but wonder how many more bugs are riddled throughout
          our codebase that we could easily prevent.
        </aside>
      </li>
      <li class="fragment">
        It's straight up admonished in
        <a href="https://www.python.org/dev/peps/pep-0008/">pep8</a>
        <aside class="notes">
          I don't normally like to make appeals to authority, but I'll make an
          exception here. It's straight up admonished in pep8 – for many of the
          same reasons.
        </aside>
      </li>
    </ol>
  </section>

  <section>
    <h1>Pain Points</h1>
    <h2>The issue</h2>
    <p>Unneccesary multithreading:</p>

    <pre class="paragraph"><code data-trim data-noescape>
DaemonTask(SendAllAutomatedEmailsJob.send_all_emails, interval=300, name="send emails")
    </code></pre>

    <aside class="notes">
      This kind of a double edged sword. Sideboard makes it really easy to spin
      up a background task that runs in a separate thread. Which is great!
      Except we've abused this feature by putting a bunch of tasks that should
      be separate processes into separate threads in the same process.
    </aside>

    <h2 class="fragment">
      Why is this an issue?
      <aside class="notes">
        Okay, so why is this an issue? What's the difference between a
        background thread and a background process?
      </aside>
    </h2>
    <ol>
      <li class="fragment">
        Makes load balancing impossible
        <aside class="notes">
          The number one issue with running tasks in a background thread is
          that it prevents us from load balancing our web servers. We'd like to
          run multiple web servers and spread the load accross them evenly.
          But if each of our web servers <em>also</em> spins up an email
          server, then each web server will be send out the same emails twice.
          <br><br>
          There's other examples of where this is a problem, but the point is
          clear. Things like our email daemon should be an entirely separate
          process.
        </aside>
      </li>
      <li class="fragment">
        <code>BADGE_LOCK</code>!
        <aside class="notes">
          Phoof... I don't even want to get into <code>BADGE_LOCK</code>, but
          if you know what I'm talking about, you'll know what a nightmare it
          is.
          <br><br>
          The good news is that I'm about <i>this close</i> to ripping it out
          completely.
        </aside>
      </li>
    </ol>
  </section>

  <section>
    <h1>Pain Points</h1>
    <h2>The issue</h2>
    <p>Sessions stored on filesystem</p>
    <h2 class="fragment">Why is this an issue?</h2>
    <ol>
      <li class="fragment">Makes load balancing impossible</li>
      <li class="fragment">Super easy to change</li>
    </ol>
  </section>

  <section>
    <h1>Pain Points</h1>
    <h2>The issue</h2>
    <p>Validations are not intrinsic to our data model</p>

    <h2 class="fragment">Why is this an issue?</h2>
    <ol>
      <li class="fragment">Easy to forget to run validations</li>
      <li class="fragment">We're unable to expose our JSON API</li>
    </ol>
  </section>

  <section>
    <h1>Pain Points</h1>
    <h2>The issue</h2>
    <p>Plugin architecture</p>

    <h2 class="fragment">Why is this an issue?</h2>
    <ol>
      <li class="fragment">
        Complexity multiplier
        <ul>
          <li class="fragment">Multiple repositories</li>
          <li class="fragment">Difficult to maintain a <code>stable</code> branch</li>
          <li class="fragment">Basic project management/issue tracking tasks become arduous, like using labels</li>
          <li class="fragment">Configuration management nightmare</li>
          <li class="fragment">Database migrations overly complex</li>
        </ul>
      </li>
      <li class="fragment">No clear value added</li>
    </ol>
  </section>

  <section>
    <h1>Pain Points</h1>
    <h2>The issue</h2>
    <p>Event configuration stored in config files</p>

    <h2 class="fragment">Why is this an issue?</h2>
    <ol>
      <li class="fragment">
        Two kinds of config:
        <ul>
          <li class="fragment">Service config (DB password, IP address/port, secret keys, etc...)</li>
          <li class="fragment">Event config (Registration dates, badge prices, departments, etc...)</li>
        </ul>
      </li>
      <li class="fragment">Changing event config requires a developer</li>
      <li class="fragment">Changing event config requires a redeployment</li>
      <li class="fragment">Difficult to integrate our software into an existing ecosystem</li>
      <li class="fragment"><code>c</code> variable is not great</li>
    </ol>
  </section>

  <section>
    <h1>Pain Points</h1>
    <h2>The issue</h2>
    <p>Naming bifurcation (Ubersystem vs RAMS)</p>

    <h2 class="fragment">Why is this an issue?</h2>
    <blockquote class="fragment text-normal" cite="https://github.com/magfest/ubersystem">
<h3 class="inline-block">IMPORTANT NOTE</h3><a class="text-xs pull-right">https://github.com/magfest/ubersystem</a>
<div>
  This is a fork of the RAMS Project used by MAGFest. It may contain
  MAGFest-specific modifications and some less well-tested code. We recommend,
  unless you are actively developing for MAGFest, that you visit the parent
  project at https://github.com/ramsproject/rams
</div>
    </blockquote>
  </section>
</section>

<section>
  <section>
    <h1>Refactor</h1>
    <p>Currently we have 15 plugins, in 15 repositories:</p>
    <div class="clearfix"></div>
    <ul class="text-sm col-4 list-none">
      <li><div class="plugin"><span class="title">attendee_tournaments</span></div></li>
      <li><div class="plugin"><span class="title">bands</span></div></li>
      <li>
        <div class="plugin"><span class="title">barcode</span></div>
        <span class="fragment text-bold">github.com/rams?!</span>
      </li>
      <li><div class="plugin"><span class="title">hotel</span></div></li>
      <li><div class="plugin"><span class="title">magclassic</span></div></li>
    </ul>
    <ul class="text-sm col-4 list-none">
      <li><div class="plugin"><span class="title">magfest</span></div></li>
      <li><div class="plugin"><span class="title">magprime</span></div></li>
      <li><div class="plugin"><span class="title">magstock</span></div></li>
      <li><div class="plugin"><span class="title">magwest</span></div></li>
      <li><div class="plugin"><span class="title">mivs</span></div></li>
    </ul>
    <ul class="text-sm col-4 list-none">
      <li><div class="plugin"><span class="title">panels</span></div></li>
      <li><div class="plugin"><span class="title">reports</span></div></li>
      <li><div class="plugin"><span class="title">tabletop</span></div></li>
      <li><div class="plugin"><span class="title">uber</span></div></li>
      <li><div class="plugin"><span class="title">uber_analytics</span></div></li>
    </ul>
    <div class="clearfix"></div>
    <div class="fragment">
      <p>Additionally we have our own application server:</p>
      <ul class="text-sm col-4 list-none">
        <li><div class="service inline-block"><span class="title">sideboard</span></div></li>
      </ul>
    </div>
  </section>

  <section>
    <h1>Refactor</h1>
    <p>We have 4 deployment configurations:</p>
    <div class="clearfix"></div>
    <div class="col-3">
      <h4>MAGFest</h4>
      <ul class="text-xs list-none">
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">attendee_tournaments</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">bands</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">barcode</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">hotel</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">magfest</span></div>
          </div>
        </li>
        <li>
          <div class="fragment grow" data-fragment-index="2">
            <div class="plugin"><span class="title">magprime</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">mivs</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">panels</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">reports</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">tabletop</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">uber</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">uber_analytics</span></div>
          </div>
        </li>
      </ul>
    </div>
    <div class="col-3">
      <h4>MAGLabs</h4>
      <ul class="text-xs list-none">
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">attendee_tournaments</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">bands</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">barcode</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">hotel</span></div>
          </div>
        </li>
        <li>
          <div class="fragment grow" data-fragment-index="2">
            <div class="plugin"><span class="title">magclassic</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">magfest</span></div>
          </div>
        </li>
        <li>
          <div class="fragment" data-fragment-index="1">
            <div class="fragment fade-out" data-fragment-index="2">
              <div class="plugin text-light"><span class="title">mivs</span></div>
            </div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">panels</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">reports</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">tabletop</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">uber</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">uber_analytics</span></div>
          </div>
        </li>
      </ul>
    </div>
    <div class="col-3">
      <h4>MAGStock</h4>
      <ul class="text-xs list-none">
        <li>
          <div class="fragment" data-fragment-index="1">
            <div class="fragment fade-out" data-fragment-index="2">
              <div class="plugin text-light"><span class="title">attendee_tournaments</span></div>
            </div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">bands</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">barcode</span></div>
          </div>
        </li>
        <li>
          <div class="fragment" data-fragment-index="1">
            <div class="fragment fade-out" data-fragment-index="2">
              <div class="plugin text-light"><span class="title">hotel</span></div>
            </div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">magfest</span></div>
          </div>
        </li>
        <li>
          <div class="fragment grow" data-fragment-index="2">
            <div class="plugin"><span class="title">magstock</span></div>
          </div>
        </li>
        <li>
          <div class="fragment" data-fragment-index="1">
            <div class="fragment fade-out" data-fragment-index="2">
              <div class="plugin text-light"><span class="title">mivs</span></div>
            </div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">panels</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">reports</span></div>
          </div>
        </li>
        <li>
          <div class="fragment" data-fragment-index="1">
            <div class="fragment fade-out" data-fragment-index="2">
              <div class="plugin text-light"><span class="title">tabletop</span></div>
            </div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">uber</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">uber_analytics</span></div>
          </div>
        </li>
      </ul>
    </div>
    <div class="col-3">
      <h4>MAGWest</h4>
      <ul class="text-xs list-none">
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">attendee_tournaments</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">bands</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">barcode</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">hotel</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">magfest</span></div>
          </div>
        </li>
        <li>
          <div class="fragment grow" data-fragment-index="2">
            <div class="plugin"><span class="title">magwest</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">mivs</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">panels</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">reports</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">tabletop</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">uber</span></div>
          </div>
        </li>
        <li>
          <div class="fragment fade-out" data-fragment-index="2">
            <div class="plugin"><span class="title">uber_analytics</span></div>
          </div>
        </li>
      </ul>
    </div>
    <div class="clearfix"></div>
    <p class="fragment text-lg" data-fragment-index="2">
      Only real differences come from the event plugins
    </p>
  </section>

  <section>
    <h1>Refactor</h1>
    <p>
      Of the event plugins, only
      <span class="plugin"><span class="title">magprime</span></span> and
      <span class="plugin"><span class="title">magstock</span></span>
      modify the database:
    </p>
    <div class="col-6">
      <h4>MAGFest</h4>
      <div class="panel db text-xs">
        <h1 class="title">prev_season_supporter</h1>
        <ul>
          <li>id</li>
          <li>first_name</li>
          <li>last_name</li>
          <li>email</li>
        </ul>
      </div>
      <div class="panel db text-xs">
        <h1 class="title">season_pass_ticket</h1>
        <ul>
          <li>id</li>
          <li>fk_id</li>
          <li>slug</li>
        </ul>
      </div>
      <div class="panel db text-xs">
        <h1 class="title">attendee</h1>
        <ul>
          <li>extra_donation</li>
        </ul>
      </div>
    </div>

    <div class="col-6">
      <h4>MAGStock</h4>
      <div class="panel db text-xs">
        <h1 class="title">attendee</h1>
        <ul>
          <li>site_type</li>
          <li>site_number</li>
          <li>purchased_food</li>
          <li>noise_level</li>
          <li>license_plate</li>
          <li>coming_with</li>
          <li>coming_as</li>
          <li>camping_type</li>
          <li>allergies</li>
        </ul>
      </div>
    </div>
  </section>

  <section>
    <h1>Refactor</h1>
    <p class="fragment fade-out" data-fragment-index="4">The structure of our deployments looks like this:</p>
    <div class="col-7">
      <div class="panel service block text-left text-sm">
        <h1 class="title inline-block fragment fade-out" data-fragment-index="4">sideboard</h1>
        <span class=" fragment fade-out" data-fragment-index="4">
          <div class="panel file inline-block pull-right fragment fade-in" data-fragment-index="0">
            <span class="title">development.ini</span>
          </div>
        </span>
        <div class="panel folder block fragment fade-in" data-fragment-index="1">
          <h1 class="title fragment fade-out" data-fragment-index="4">plugins</h1>
          <div class="fragment fade-in" data-fragment-index="2">
            <ul class="col-6 fragment fade-out" data-fragment-index="4">
              <li><div class="plugin"><span class="title">attendee_tournaments</span></div></li>
              <li><div class="plugin"><span class="title">bands</span></div></li>
              <li><div class="plugin"><span class="title">barcode</span></div></li>
              <li><div class="plugin"><span class="title">hotel</span></div></li>
              <li><div class="plugin"><span class="title">magfest</span></div></li>
              <li><div class="plugin"><span class="title">magprime</span></div></li>
            </ul>
            <ul class="col-6">
              <li><div class="plugin fragment fade-out" data-fragment-index="4"><span class="title">mivs</span></div></li>
              <li><div class="plugin fragment fade-out" data-fragment-index="4"><span class="title">panels</span></div></li>
              <li><div class="plugin fragment fade-out" data-fragment-index="4"><span class="title">reports</span></div></li>
              <li><div class="plugin fragment fade-out" data-fragment-index="4"><span class="title">tabletop</span></div></li>
              <li>
                <div class="plugin fragment grow" data-fragment-index="4">
                  <span class="title">uber</span>
                  <div class="panel file inline-block pull-right fragment fade-in" data-fragment-index="3">
                    <span class="title">development.ini</span>
                  </div>
                  <div class="clearfix"></div>
                </div>
              </li>
              <li><div class="plugin fragment fade-out" data-fragment-index="4"><span class="title">uber_analytics</span></div></li>
            </ul>
          </div>
          <div class="clearfix"></div>
        </div>
      </div>
    </div>
    <div class="col-5">
      <p class="fragment fade-in" data-fragment-index="4" style="margin-top: 58%">
        95% of the work happens here
      </p>
    </div>
  </section>

  <section>
    <h1>Refactor</h1>
    <p>A complete rewrite is almost always a bad idea, but what about...</p>
    <div class="col-7">
      <div class="panel service block text-left text-sm">
        <h1 class="title fragment fade-in" data-fragment-index="0">Ubersystem</h1>
        <div class="panel package block fragment fade-in" data-fragment-index="1">
          <h1 class="title">python modules</h1>
          <ul class="col-6">
            <li>uber</li>
            <li>uber.analytics</li>
            <li>uber.attendee_tournaments</li>
            <li>uber.bands</li>
            <li>uber.barcode</li>
            <li>uber.core</li>
          </ul>
          <ul class="col-6">
            <li>uber.hotel</li>
            <li>uber.magfest</li>
            <li>uber.mivs</li>
            <li>uber.panels</li>
            <li>uber.reports</li>
            <li>uber.tabletop</li>
          </ul>
          <div class="clearfix"></div>
        </div>
        <div class="panel file block fragment fade-in" data-fragment-index="2">
          <h1 class="title">requirements.txt</h1>
          <div class="col-12">sideboard>=1.0</div>
          <div class="clearfix"></div>
        </div>
        <div class="panel file block fragment fade-in" data-fragment-index="3">
          <h1 class="title">ubersystem.cfg</h1>
        </div>
      </div>
    </div>
    <div class="col-5 text-sm">
      <p class="fragment fade-in" data-fragment-index="0">
        Single repository
      </p>
      <p class="fragment fade-in" data-fragment-index="1">
        Plugins converted to regular python modules
      </p>
      <p class="fragment fade-in" data-fragment-index="2" style="margin-top: 36%;">
        Sideboard imported like a normal library
      </p>
      <p class="fragment fade-in" data-fragment-index="3" style="margin-top: 11%;">
        Single config file
      </p>
    </div>
  </section>

  <section>
    <h1 style="margin-bottom: 0;">Refactor</h1>
    <h3>Service config</h3>
    <div class="panel file text-xs">
      <h1 class="title">ubersystem.cfg</h1>
<pre><code data-trim data-noescape>
aws_access_key = "abcxyz"
aws_secret_key = "abcxyz"
qr_code_password = "abcxyz"
stripe_secret_key = "sk_test_abcxyz"
stripe_public_key = "pk_test_abcxyz"

[cherrypy]
server.socket_host = "127.0.0.1"
server.socket_port = 8282

[sqlalchemy]
url = "postgresql://user:pass@localhost:5432/db"
</code></pre>
    </div>
    <ul>
      <li class="fragment">Makes packaging super easy</li>
      <li class="fragment">Makes configuration management super easy</li>
      <li class="fragment">Makes containerization super easy</li>
      <li class="fragment">Universally understood paradigm</li>
      <li class="fragment">
        Think of your config as an API
        <span class="fragment"> – don't burden yourself with an overly complex API</span>
      </li>
    </ul>
  </section>

  <section>
    <h1 style="margin-bottom: 0;">Refactor</h1>
    <h3>Event config</h3>
    <div class="col-6">
      <div class="panel file text-xs">
        <h1 class="title">development.ini</h1>
<pre><code data-trim data-noescape><span class="fragment fade-in" data-fragment-index="1">at_the_con = False
event_timezone = "US/Pacific"
event_venue = "The Hyatt Regency"
event_venue_address = "5101 Great America Pkwy"
max_badge_sales = 20000
student_discount = 10</span>

<span class="fragment fade-in" data-fragment-index="4">[badge_ranges]
staff_badge = 49, 199
guest_badge = 200, 299
attendee_badge = 300, 2299
one_day_badge = 2300, 3199</span>

<span class="fragment fade-in" data-fragment-index="6">[enums]
[[job_location]]
arcade = "Arcade"
challenges = "Challenges"
charity = "Charity"
chipspace = "Chipspace"
dorsai = "Dorsai"</span>
</code></pre>
      </div>
    </div>
    <div class="col-6">
      <div class="col-6" style="padding-left: 0">
        <div class="panel db text-xs fragment fade-in" data-fragment-index="2">
          <h1 class="title">event</h1>
          <ul>
            <li>id: <i>uuid</i></li>
            <li>at_the_con: <i>boolean</i></li>
            <li>timezone: <i>text</i></li>
            <li>max_badge_sales: <i>int</i></li>
            <li>student_discount: <i>int</i></li>
            <li class="fragment fade-in" data-fragment-index="3">venue_id: <i>foreign_key</i></li>
            <li class="fragment fade-in" data-fragment-index="5">badge_ranges: <i>jsonb</i></li>
          </ul>
        </div>
      </div>
      <div class="col-6" style="padding-right: 0">
        <div class="panel db text-xs fragment fade-in" data-fragment-index="3">
          <h1 class="title">venue</h1>
          <ul>
            <li>id: <i>uuid</i></li>
            <li>address: <i>text</i></li>
            <li>name: <i>text</i></li>
          </ul>
        </div>
      </div>
      <div class="clearfix" style="margin-bottom: 15px;"></div>
      <div class="col-6" style="padding-left: 0">
        <div class="panel db text-xs fragment fade-in" data-fragment-index="7">
          <h1 class="title">department</h1>
          <ul>
            <li>id: <i>uuid</i></li>
            <li>name: <i>text</i></li>
            <li>description: <i>text</i></li>
          </ul>
        </div>
      </div>
      <div class="col-6" style="padding-right: 0">
        <div class="panel db text-xs fragment fade-in" data-fragment-index="8">
          <h1 class="title">event_department</h1>
          <ul>
            <li>event_id: <i>uuid</i></li>
            <li>department_id: <i>uuid</i></li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <section>
    <h1 style="margin-bottom: 0;">Refactor</h1>

    <div class="panel db text-xs">
      <h1 class="title">event</h1>
      <div class="db-table">
        <table>
          <thead>
            <tr>
              <th>id</th>
              <th>name</th>
              <th>start_date</th>
              <th>end_date</th>
              <th>timezone</th>
              <th>&nbsp;...&nbsp;</th>
              <th>&nbsp;...&nbsp;</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><span class="fragment fade-in" data-fragment-index="1">b652524c...</span></td>
              <td><span class="fragment fade-in" data-fragment-index="1">Super MAGFest 2017</span></td>
              <td><span class="fragment fade-in" data-fragment-index="1">2017-01-05 12:00</span></td>
              <td><span class="fragment fade-in" data-fragment-index="1">2017-01-09 12:00</span></td>
              <td><span class="fragment fade-in" data-fragment-index="1">EST</span></td>
              <td><span class="fragment fade-in" data-fragment-index="1">&nbsp;...&nbsp;</span></td>
              <td><span class="fragment fade-in" data-fragment-index="1">&nbsp;...&nbsp;</span></td>
            </tr>
            <tr>
              <td><span class="fragment fade-in" data-fragment-index="2">7ff9ec4e...</span></td>
              <td><span class="fragment fade-in" data-fragment-index="2">Super MAGFest 2018</span></td>
              <td><span class="fragment fade-in" data-fragment-index="2">2018-01-04 12:00</span></td>
              <td><span class="fragment fade-in" data-fragment-index="2">2018-01-08 12:00</span></td>
              <td><span class="fragment fade-in" data-fragment-index="2">EST</span></td>
              <td><span class="fragment fade-in" data-fragment-index="2">&nbsp;...&nbsp;</span></td>
              <td><span class="fragment fade-in" data-fragment-index="2">&nbsp;...&nbsp;</span></td>
            </tr>
            <tr>
              <td><span class="fragment fade-in" data-fragment-index="3">527b039a...</span></td>
              <td><span class="fragment fade-in" data-fragment-index="3">MAGWest 2017</span></td>
              <td><span class="fragment fade-in" data-fragment-index="3">2017-08-25 12:00</span></td>
              <td><span class="fragment fade-in" data-fragment-index="3">2017-08-27 12:00</span></td>
              <td><span class="fragment fade-in" data-fragment-index="3">PDT</span></td>
              <td><span class="fragment fade-in" data-fragment-index="3">&nbsp;...&nbsp;</span></td>
              <td><span class="fragment fade-in" data-fragment-index="3">&nbsp;...&nbsp;</span></td>
            </tr>
            <tr>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td>&nbsp;</td>
              <td>&nbsp;</td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td>&nbsp;</td>
              <td>&nbsp;</td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td>&nbsp;</td>
              <td>&nbsp;</td>
              <td>&nbsp;</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="panel db text-xs fragment fade-in" data-fragment-index="4" style="margin-top: 1.5em;">
      <h1 class="title">attendee</h1>
      <div class="db-table">
        <table>
          <thead>
            <tr>
              <th>id</th>
              <th>badge_num</th>
              <th>registered</th>
              <th>staffing</th>
              <th>&nbsp;...&nbsp;</th>
              <th>&nbsp;...&nbsp;</th>
              <th>&nbsp;...&nbsp;</th>
              <th class="fragment fade-in" data-fragment-index="8">event_id</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><span class="fragment fade-in" data-fragment-index="5">9a71a504...</span></td>
              <td><span class="fragment fade-in" data-fragment-index="5">53</span></td>
              <td><span class="fragment fade-in" data-fragment-index="5">2017-08-08 19:52</span></td>
              <td><span class="fragment fade-in" data-fragment-index="5">True</span></td>
              <td><span class="fragment fade-in" data-fragment-index="5">&nbsp;...&nbsp;</span></td>
              <td><span class="fragment fade-in" data-fragment-index="5">&nbsp;...&nbsp;</span></td>
              <td><span class="fragment fade-in" data-fragment-index="5">&nbsp;...&nbsp;</span></td>
              <td class="fragment fade-in" data-fragment-index="8">7ff9ec4e...</td>
            </tr>
            <tr>
              <td><span class="fragment fade-in" data-fragment-index="6">569e914b...</span></td>
              <td><span class="fragment fade-in" data-fragment-index="6">54</span></td>
              <td><span class="fragment fade-in" data-fragment-index="6">2017-08-09 12:01</span></td>
              <td><span class="fragment fade-in" data-fragment-index="6">True</span></td>
              <td><span class="fragment fade-in" data-fragment-index="6">&nbsp;...&nbsp;</span></td>
              <td><span class="fragment fade-in" data-fragment-index="6">&nbsp;...&nbsp;</span></td>
              <td><span class="fragment fade-in" data-fragment-index="6">&nbsp;...&nbsp;</span></td>
              <td class="fragment fade-in" data-fragment-index="8">7ff9ec4e...</td>
            </tr>
            <tr>
              <td><span class="fragment fade-in" data-fragment-index="7">b729f113...</span></td>
              <td><span class="fragment fade-in" data-fragment-index="7">52</span></td>
              <td><span class="fragment fade-in" data-fragment-index="7">2017-08-10 07:08</span></td>
              <td><span class="fragment fade-in" data-fragment-index="7">False</span></td>
              <td><span class="fragment fade-in" data-fragment-index="7">&nbsp;...&nbsp;</span></td>
              <td><span class="fragment fade-in" data-fragment-index="7">&nbsp;...&nbsp;</span></td>
              <td><span class="fragment fade-in" data-fragment-index="7">&nbsp;...&nbsp;</span></td>
              <td class="fragment fade-in" data-fragment-index="8">527b039a...</td>
            </tr>
            <tr>
              <td><span class="fragment fade-in" data-fragment-index="9">ba618d99...</span></td>
              <td><span class="fragment fade-in" data-fragment-index="9">53</span></td>
              <td><span class="fragment fade-in" data-fragment-index="9">2017-08-11 09:26</span></td>
              <td><span class="fragment fade-in" data-fragment-index="9">True</span></td>
              <td><span class="fragment fade-in" data-fragment-index="9">&nbsp;...&nbsp;</span></td>
              <td><span class="fragment fade-in" data-fragment-index="9">&nbsp;...&nbsp;</span></td>
              <td><span class="fragment fade-in" data-fragment-index="9">&nbsp;...&nbsp;</span></td>
              <td class="fragment fade-in" data-fragment-index="8"><span class="fragment fade-in" data-fragment-index="9">527b039a...</span></td>
            </tr>
            <tr>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td>&nbsp;</td>
              <td>&nbsp;</td>
              <td>&nbsp;</td>
              <td class="fragment fade-in" data-fragment-index="8"></td>
            </tr>
            <tr>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td>&nbsp;</td>
              <td>&nbsp;</td>
              <td>&nbsp;</td>
              <td class="fragment fade-in" data-fragment-index="8"></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </section>

  <section>
    <h1 style="margin-bottom: 0;">Refactor</h1>
    <h2>That's not the end of the story!</h2>
    <ol>
      <li class="fragment">
        Split <code>attendee</code> table into <code>person</code> table and <code>registration</code> table
      </li>
      <li class="fragment">Create actual user accounts!</li>
      <li class="fragment">Fine grained permissions model</li>
      <li class="fragment">Customizable templates by storing user editable blocks in the database</li>
      <li class="fragment">Support online creation and editing of automated emails</li>
      <li class="fragment">And many more features as we go!</li>
    </ol>
  </section>
</section>

<section>
  <section>
    <h1>Reggie</h1>
    <h2 class="fragment">The registration system!</h2>
  </section>

  <section>
    <h1>Reggie</h1>
    <div class="img">
      <img class="img-layer fragment fade-in" src="images/architecture01.png">
      <img class="img-layer fragment fade-in" src="images/architecture02.png">
      <img class="img-layer fragment fade-in" src="images/architecture03.png">
      <img class="img-layer fragment fade-in" src="images/architecture04.png">
      <img class="img-layer fragment fade-in" src="images/architecture05.png">
      <img class="img-layer fragment fade-in" src="images/architecture06.png">
      <img class="img-layer fragment fade-in" src="images/architecture07.png">
      <img class="img-layer fragment fade-in" src="images/architecture08.png">
      <img class="img-layer fragment fade-in" src="images/architecture09.png">
      <img class="img-layer fragment fade-in" src="images/architecture10.png">
    </div>
  </section>

  <section>
    <h1>Reggie</h1>
    <h2>Future Improvements</h2>
    <ol>
      <li class="fragment">Database replication with failover</li>
      <li class="fragment">Database caching layer</li>
      <li class="fragment">Database sharding, perhaps per-event</li>
      <li class="fragment">LDAP authentication</li>
      <li class="fragment">Pub/sub message queue</li>
      <li class="fragment">Web socket support</li>
    </ol>
  </section>
</section>

      </div>
    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>

    <script>
      function hasClass(element, selector) {
          var className = " " + selector + " ";
          return (element.nodeType === 1 && (" " + element.className + " ").replace(/[\t\r\n]/g, " ").indexOf(className) >= 0);
      }

      // More info https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: false,

        width: 1600,
        height: 900,

        transition: 'slide', // none/fade/slide/convex/concave/zoom
        transitionSpeed: 'fast', // default/fast/slow
        backgroundTransition: 'fade', // none/fade/slide/convex/concave/zoom

        // More info https://github.com/hakimel/reveal.js#dependencies
        dependencies: [
          { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
          { src: 'plugin/zoom-js/zoom.js', async: true },
          { src: 'plugin/notes/notes.js', async: true }
        ]
      });

      Reveal.addEventListener('fragmentshown', function(event) {
        if (hasClass(event.fragment, 'fragment-bg-red')) {
          console.log('fragment-bg-red')
        }
      });

    </script>
  </body>
</html>
